1. Create table: 
CREATE TABLE IF NOT EXISTS taxidata
(vendor_id string, pickup_datetime string,
dropoff_datetime string, passenger_count int, trip_distance DECIMAL(9,6),
pickup_longitude DECIMAL(9,6), pickup_latitude DECIMAL(9,6), rate_code int,
store_and_fwd_flag string, dropoff_longitude DECIMAL(9,6), dropoff_latitude
DECIMAL(9,6),
payment_type string, fare_amount DECIMAL(9,6), extra DECIMAL(9,6),
mta_tax DECIMAL(9,6), tip_amount DECIMAL(9,6), tolls_amount DECIMAL(9,6),
total_amount DECIMAL(9,6), trip_time_in_secs int )
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED as TEXTFILE
TBLPROPERTIES ("skip.header.line.count"="1");

2. Load the taxidata in the table
load data local inpath 'yellow_tripdata_2015-01-06.csv' into table taxidata;


a. What is the total Number of trips ( equal to the number of rows)?
solution:
query: select count(0) from taxidata;
output: 10000

b. What is the total revenue generated by all the trips? The fare is stored in the column total_amount.
solution:
query: 	select sum(total_amount) from taxidata;
Output: 160546.81

c. What fraction of the total is paid for tolls? The toll is stored in tolls_amount.
solution:
query1: select sum(tolls_amount) from taxidata;
Output1: Total Toll amount: 2496.99 
query2: select sum(tolls_amount)/sum(total_amount)*100 from taxidata;
Output2: Percentage of the total is paid for tolls : 1.56%
	
d. What fraction of it is driver tips? The tip is stored in tip_amount.
solution:
query1: select sum(tip_amount) from taxidata;
Output1: Total Toll amount: 17315.3
query2: select sum(tip_amount)/sum(total_amount)*100 from taxidata;
Output2: Percentage of the total is paid for tolls : 10.79%

e. What is the average trip amount?
solution:
query: 	select avg(total_amount) from taxidata;
Output: 16.054681

f. What is the average distance of the trips? Distance is stored in the column trip_distance.
solution:
query: select avg(trip_distance) from taxidata;
Output:3.253033

g. How many different payment types are used?
solution: 
query: select count(DISTINCT payment_type) from taxidata;
Output: 4 (DISTINCT payment_type: 1,2,3,4)

h. For each payment type, display the following details:
Average fare generated
Average tip
Average tax â€“ tax is stored in column mta_tax

solution:
query: select payment_type, avg(fare_amount), avg(tip_amount),avg(mta_tax) from taxidata group by payment_type;
Output: 
payment_type	avg(fare_amount) avg(tip_amount) avg(mta_tax)
1				13.5610182727	 2.7042480087	 0.4971107293
2				11.3933830986	 0				 0.4988732394
3				13.2107894737	 0	 			 0.4210526316
4				12.2222222222	 0	 			 0.5

i. On average which hour of the day generates the highest revenue?
solution:
query: select hour(pickup_datetime),hour(dropoff_datetime) ,avg(total_amount) as avg_tamount from taxidata group by hour(pickup_datetime),hour(dropoff_datetime) order by avg_tamount desc limit 1;
Output: There is highest avarage total_amount : 53.55 between 11PM to 12 AM. So highest revenue is generated between 11PM to 12 AM.